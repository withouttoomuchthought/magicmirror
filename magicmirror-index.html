<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>magicmirror ¬∑ the reflection portal</title>
    <meta name="description" content="type what's on your heart. the mirror listens, breathes with you, and softly reflects back what your heart was really trying to say.">
    <meta name="theme-color" content="#D9D7F3">
    
    <!-- Open Graph -->
    <meta property="og:title" content="magicmirror ¬∑ the reflection portal">
    <meta property="og:description" content="type what's on your heart. the mirror reflects back what your heart was really trying to say.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://magicmirror.withouttoomuchthought.com">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&family=Karla:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --lilac: #D9D7F3;
            --lilac-deep: #C4C1E8;
            --lilac-light: #EEEDF8;
            --lavender: #E8E4F3;
            --purple-soft: #B8B5D9;
            --violet-mist: #D4D0F0;
            --cream: #FAF9F6;
            --ink: #2F2F2F;
            --text: #5A5A5A;
            --text-soft: #7A7A8A;
            
            --gradient-1: #E8E4F3;
            --gradient-2: #D9D7F3;
            --gradient-3: #E4DFF5;
            --gradient-4: #DDD8F0;
            
            --font-title: 'Playfair Display', Georgia, serif;
            --font-body: 'Karla', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-body);
            background: linear-gradient(135deg, var(--gradient-1) 0%, var(--gradient-2) 35%, var(--gradient-3) 65%, var(--gradient-4) 100%);
            background-size: 400% 400%;
            animation: gradientFlow 22s ease infinite;
            background-attachment: fixed;
            min-height: 100vh;
            color: var(--text);
            line-height: 1.8;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        @keyframes gradientFlow {
            0%, 100% { background-position: 0% 50%; }
            25% { background-position: 50% 100%; }
            50% { background-position: 100% 50%; }
            75% { background-position: 50% 0%; }
        }

        /* ========================================
           BACK BUTTON
        ======================================== */
        .back-home {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            padding: 10px 18px;
            border-radius: 30px;
            font-family: var(--font-body);
            font-size: 0.85rem;
            color: var(--text);
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.06);
        }

        .back-home:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        /* ========================================
           PARTICLES
        ======================================== */
        .particle-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            opacity: 0;
            animation: floatUp linear infinite;
        }

        .particle.small {
            width: 3px;
            height: 3px;
            background: rgba(255, 255, 255, 0.7);
            box-shadow: 0 0 6px rgba(217, 215, 243, 0.8);
        }

        .particle.medium {
            width: 5px;
            height: 5px;
            background: rgba(217, 215, 243, 0.6);
            box-shadow: 0 0 10px rgba(217, 215, 243, 0.9);
        }

        .particle.large {
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.9), rgba(217, 215, 243, 0.4));
            box-shadow: 0 0 15px rgba(217, 215, 243, 0.8);
        }

        @keyframes floatUp {
            0% {
                transform: translateY(100vh) translateX(0) scale(0);
                opacity: 0;
            }
            10% { opacity: 0.8; transform: translateY(90vh) scale(1); }
            90% { opacity: 0.6; }
            100% {
                transform: translateY(-50px) translateX(var(--drift, 0px)) scale(0.5);
                opacity: 0;
            }
        }

        /* ========================================
           LANDING PAGE
        ======================================== */
        .landing-page {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 30px;
            text-align: center;
            position: relative;
            z-index: 10;
        }

        .landing-icon {
            font-size: 5rem;
            margin-bottom: 30px;
            animation: gentleFloat 4s ease-in-out infinite;
            filter: drop-shadow(0 10px 30px rgba(217, 215, 243, 0.5));
        }

        @keyframes gentleFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .landing-title {
            font-family: var(--font-title);
            font-size: clamp(2.2rem, 7vw, 3.5rem);
            font-weight: 500;
            color: var(--ink);
            margin-bottom: 15px;
            letter-spacing: -0.5px;
        }

        .landing-subtitle {
            font-size: 1.15rem;
            color: var(--text-soft);
            margin-bottom: 50px;
            font-style: italic;
        }

        .landing-card {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            border-radius: 35px;
            padding: 50px 45px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.06);
            margin-bottom: 40px;
        }

        .landing-section {
            margin-bottom: 40px;
        }

        .landing-section:last-child {
            margin-bottom: 0;
        }

        .landing-section h3 {
            font-family: var(--font-title);
            font-size: 1.4rem;
            font-weight: 500;
            color: var(--ink);
            margin-bottom: 20px;
        }

        .landing-section p {
            font-size: 1.1rem;
            line-height: 2;
            color: var(--text);
            margin-bottom: 15px;
        }

        .landing-steps {
            text-align: left;
            padding-left: 10px;
        }

        .landing-step {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 18px;
            font-size: 1.05rem;
            line-height: 1.7;
        }

        .step-number {
            background: linear-gradient(135deg, var(--lilac), var(--lilac-deep));
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 600;
            flex-shrink: 0;
            margin-top: 2px;
            box-shadow: 0 3px 10px rgba(217, 215, 243, 0.5);
        }

        .landing-poem {
            font-size: 1.2rem;
            font-style: italic;
            color: var(--text-soft);
            line-height: 2.2;
            margin: 35px 0;
            padding: 25px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            border-left: 3px solid var(--lilac-deep);
        }

        .landing-features {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            margin-top: 25px;
        }

        .feature-tag {
            background: rgba(217, 215, 243, 0.4);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--text);
        }

        .enter-btn {
            display: inline-block;
            padding: 18px 50px;
            background: linear-gradient(135deg, var(--lilac), var(--lilac-deep));
            border: none;
            border-radius: 50px;
            color: white;
            font-family: var(--font-body);
            font-size: 1.1rem;
            font-weight: 500;
            letter-spacing: 0.5px;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 8px 30px rgba(217, 215, 243, 0.5);
            text-decoration: none;
        }

        .enter-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(217, 215, 243, 0.7);
        }

        .enter-btn:active {
            transform: translateY(-1px);
        }

        .coming-soon {
            margin-top: 30px;
            font-size: 0.95rem;
            color: var(--text-soft);
        }

        /* ========================================
           MIRROR APP SECTION
        ======================================== */
        .mirror-app {
            min-height: 100vh;
            padding: 40px 20px 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 10;
        }

        .mirror-header {
            text-align: center;
            margin-bottom: 30px;
            padding-top: 20px;
        }

        .mirror-header-icon {
            font-size: 3rem;
            margin-bottom: 10px;
            animation: gentleFloat 4s ease-in-out infinite;
        }

        .mirror-header h1 {
            font-family: var(--font-title);
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            font-weight: 500;
            color: var(--ink);
        }

        /* Input View */
        .mirror-container {
            width: 100%;
            max-width: 550px;
            margin: 0 auto;
        }

        .input-view, .result-view {
            display: none;
        }

        .input-view.active, .result-view.active {
            display: block;
            animation: fadeIn 0.6s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .mirror-card {
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            border-radius: 30px;
            padding: 40px 35px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.06);
        }

        .input-prompt {
            font-size: 1rem;
            color: var(--text-soft);
            margin-bottom: 20px;
            font-style: italic;
            text-align: center;
        }

        .mirror-textarea {
            width: 100%;
            min-height: 180px;
            padding: 22px;
            border: 2px solid rgba(217, 215, 243, 0.5);
            border-radius: 20px;
            font-family: var(--font-body);
            font-size: 1.05rem;
            line-height: 1.8;
            color: var(--ink);
            background: rgba(255, 255, 255, 0.6);
            resize: none;
            transition: all 0.3s ease;
        }

        .mirror-textarea:focus {
            outline: none;
            border-color: var(--lilac-deep);
            background: rgba(255, 255, 255, 0.85);
            box-shadow: 0 0 0 4px rgba(217, 215, 243, 0.3);
        }

        .mirror-textarea::placeholder {
            color: #AAA;
            font-style: italic;
        }

        .char-count {
            text-align: right;
            font-size: 0.8rem;
            color: var(--text-soft);
            margin-top: 10px;
            margin-bottom: 25px;
        }

        .transform-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--lilac), var(--lilac-deep));
            border: none;
            border-radius: 50px;
            color: white;
            font-family: var(--font-body);
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 6px 25px rgba(217, 215, 243, 0.5);
        }

        .transform-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 35px rgba(217, 215, 243, 0.6);
        }

        .transform-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Loading State */
        .loading-view {
            display: none;
            text-align: center;
            padding: 60px 30px;
        }

        .loading-view.active {
            display: block;
        }

        .loading-icon {
            font-size: 4rem;
            margin-bottom: 25px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.1); opacity: 1; }
        }

        .loading-text {
            font-size: 1.1rem;
            color: var(--text-soft);
            font-style: italic;
            line-height: 1.8;
        }

        /* Result View */
        .result-card {
            background: rgba(255, 255, 255, 0.55);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            border-radius: 30px;
            padding: 35px 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.06);
        }

        .original-input {
            font-size: 0.9rem;
            color: var(--text-soft);
            margin-bottom: 8px;
            font-style: italic;
        }

        .original-text {
            font-size: 1rem;
            color: var(--text);
            padding: 15px 18px;
            background: rgba(217, 215, 243, 0.2);
            border-radius: 15px;
            margin-bottom: 25px;
            font-style: italic;
            border-left: 3px solid var(--lilac-deep);
        }

        .reflection-box {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 20px;
            padding: 28px;
            margin-bottom: 20px;
            border: 1px solid rgba(217, 215, 243, 0.4);
        }

        .reflection-text {
            font-size: 1.1rem;
            line-height: 2;
            color: var(--ink);
            white-space: pre-wrap;
        }

        .reflection-meta {
            text-align: center;
            font-size: 0.85rem;
            color: var(--text-soft);
            font-style: italic;
            margin-bottom: 15px;
        }

        .ai-disclaimer {
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-soft);
            padding: 12px;
            background: rgba(217, 215, 243, 0.15);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .action-btn {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(217, 215, 243, 0.5);
            border-radius: 25px;
            font-family: var(--font-body);
            font-size: 0.95rem;
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateY(-2px);
        }

        /* Share Buttons */
        .share-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }

        .share-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.6);
            border: 1px solid rgba(217, 215, 243, 0.4);
            border-radius: 15px;
            font-family: var(--font-body);
            font-size: 1rem;
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .share-btn:hover {
            background: rgba(255, 255, 255, 0.85);
            transform: translateX(5px);
        }

        .share-btn-icon {
            font-size: 1.3rem;
        }

        .share-btn-text {
            display: flex;
            flex-direction: column;
        }

        .share-btn-title {
            font-weight: 500;
            color: var(--ink);
        }

        .share-btn-desc {
            font-size: 0.8rem;
            color: var(--text-soft);
        }

        /* Support Box */
        .support-box {
            background: linear-gradient(135deg, rgba(217, 215, 243, 0.3), rgba(232, 228, 243, 0.3));
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .support-box p {
            font-size: 0.95rem;
            color: var(--text);
            margin-bottom: 12px;
        }

        .support-link {
            display: inline-block;
            padding: 10px 25px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 25px;
            color: var(--ink);
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .support-link:hover {
            background: rgba(255, 255, 255, 0.95);
            transform: translateY(-2px);
        }

        /* Try Again Button */
        .try-again-btn {
            width: 100%;
            padding: 16px;
            background: transparent;
            border: 2px solid var(--lilac-deep);
            border-radius: 50px;
            color: var(--text);
            font-family: var(--font-body);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .try-again-btn:hover {
            background: var(--lilac-deep);
            color: white;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(47, 47, 47, 0.9);
            color: white;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 0.95rem;
            z-index: 9999;
            transition: transform 0.4s ease;
            backdrop-filter: blur(10px);
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
        }

        /* ========================================
           RESPONSIVE
        ======================================== */
        @media (max-width: 600px) {
            .landing-page {
                padding: 40px 20px;
            }

            .landing-card {
                padding: 35px 25px;
            }

            .landing-icon {
                font-size: 4rem;
            }

            .mirror-card, .result-card {
                padding: 30px 22px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .action-btn {
                width: 100%;
            }
        }

        /* ========================================
           REDUCED MOTION
        ======================================== */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }

            .particle-container {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Back to Home -->
    <a href="https://withouttoomuchthought.com" class="back-home">‚Üê back to wtmt</a>

    <!-- Particles -->
    <div class="particle-container" id="particles"></div>

    <!-- Landing Page -->
    <section class="landing-page" id="landing">
        <div class="landing-icon">üîÆ</div>
        <h1 class="landing-title">magicmirror</h1>
        <p class="landing-subtitle">the reflection portal</p>

        <div class="landing-card">
            <div class="landing-section">
                <h3>‚ú® what is this?</h3>
                <p>
                    a gentle space to pour out what's on your heart ‚Äî<br>
                    and receive it back, transformed.
                </p>
                <p>
                    it's not about fixing you.<br>
                    it's about <em>seeing</em> you.
                </p>
            </div>

            <div class="landing-section">
                <h3>üåô how it works</h3>
                <div class="landing-steps">
                    <div class="landing-step">
                        <span class="step-number">1</span>
                        <span>type what's on your heart ‚Äî something heavy, honest, or unspoken</span>
                    </div>
                    <div class="landing-step">
                        <span class="step-number">2</span>
                        <span>press <strong>transform</strong> and let the mirror hold your words</span>
                    </div>
                    <div class="landing-step">
                        <span class="step-number">3</span>
                        <span>receive a soft reflection ‚Äî what your heart was really trying to say</span>
                    </div>
                </div>
            </div>

            <div class="landing-poem">
                the world outside moves fast.<br>
                but here... truth slows down<br>
                long enough to be held. üåô
            </div>

            <div class="landing-section">
                <h3>üí´ you can...</h3>
                <div class="landing-features">
                    <span class="feature-tag">save your reflection</span>
                    <span class="feature-tag">copy it</span>
                    <span class="feature-tag">share it</span>
                    <span class="feature-tag">download as art</span>
                </div>
            </div>
        </div>

        <a href="#mirror" class="enter-btn">step through the mirror ü™û</a>

        <p class="coming-soon">üí´ coming soon: memory mirror ¬∑ color this truth</p>
    </section>

    <!-- Mirror App -->
    <section class="mirror-app" id="mirror">
        <div class="mirror-header">
            <div class="mirror-header-icon">ü™û</div>
            <h1>magicmirror</h1>
        </div>

        <div class="mirror-container">
            <!-- Input View -->
            <div class="input-view active" id="inputView">
                <div class="mirror-card">
                    <p class="input-prompt">type what's on your heart...</p>
                    <textarea 
                        class="mirror-textarea" 
                        id="userInput" 
                        placeholder="something heavy, something honest, something you've never said out loud..."
                        maxlength="2000"
                    ></textarea>
                    <div class="char-count"><span id="charCount">0</span>/2000</div>
                    <button class="transform-btn" id="transformBtn" disabled>
                        transform ü™û‚ú®
                    </button>
                </div>
            </div>

            <!-- Loading View -->
            <div class="loading-view" id="loadingView">
                <div class="mirror-card">
                    <div class="loading-icon">ü™û</div>
                    <p class="loading-text" id="loadingText">the mirror is listening...</p>
                </div>
            </div>

            <!-- Result View -->
            <div class="result-view" id="resultView">
                <div class="result-card">
                    <p class="original-input">you wrote:</p>
                    <div class="original-text" id="originalText"></div>

                    <div class="reflection-box">
                        <p class="reflection-text" id="reflectionText"></p>
                    </div>

                    <p class="reflection-meta">a soft reflection by wtmt ¬∑ just now</p>

                    <p class="ai-disclaimer">
                        these reflections come from ai. take what resonates, leave what doesn't. trust your own truth first üíõ
                    </p>

                    <!-- Action Buttons -->
                    <div class="action-buttons">
                        <button class="action-btn" id="copyBtn">copy</button>
                    </div>

                    <!-- Share Buttons -->
                    <div class="share-buttons">
                        <button class="share-btn" id="shareBtn">
                            <span class="share-btn-icon">üå∏</span>
                            <span class="share-btn-text">
                                <span class="share-btn-title">share your truth</span>
                                <span class="share-btn-desc">tiktok story, instagram, anywhere you want</span>
                            </span>
                        </button>
                        <button class="share-btn" id="downloadBtn">
                            <span class="share-btn-icon">üé®</span>
                            <span class="share-btn-text">
                                <span class="share-btn-title">download as art</span>
                                <span class="share-btn-desc">save this as a beautiful reminder</span>
                            </span>
                        </button>
                    </div>

                    <!-- Support Box -->
                    <div class="support-box">
                        <p>‚òï if this helped, you can support this space</p>
                        <a href="https://buymeacoffee.com/withouttoomuchthought" target="_blank" class="support-link">
                            buy me a coffee üíõ
                        </a>
                    </div>

                    <button class="try-again-btn" id="tryAgainBtn">try again üåô</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <!-- Hidden Canvas for Download -->
    <canvas id="downloadCanvas" style="display: none;"></canvas>

    <script>
        // ========================================
        // PARTICLES
        // ========================================
        function createParticles() {
            const container = document.getElementById('particles');
            const types = ['small', 'medium', 'large'];
            const counts = { small: 20, medium: 12, large: 6 };

            types.forEach(type => {
                for (let i = 0; i < counts[type]; i++) {
                    const particle = document.createElement('div');
                    particle.className = `particle ${type}`;
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.animationDuration = (10 + Math.random() * 15) + 's';
                    particle.style.animationDelay = Math.random() * 20 + 's';
                    particle.style.setProperty('--drift', (Math.random() - 0.5) * 100 + 'px');
                    container.appendChild(particle);
                }
            });
        }

        createParticles();

        // ========================================
        // DOM ELEMENTS
        // ========================================
        const userInput = document.getElementById('userInput');
        const charCount = document.getElementById('charCount');
        const transformBtn = document.getElementById('transformBtn');
        const inputView = document.getElementById('inputView');
        const loadingView = document.getElementById('loadingView');
        const resultView = document.getElementById('resultView');
        const loadingText = document.getElementById('loadingText');
        const originalText = document.getElementById('originalText');
        const reflectionText = document.getElementById('reflectionText');
        const copyBtn = document.getElementById('copyBtn');
        const shareBtn = document.getElementById('shareBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const tryAgainBtn = document.getElementById('tryAgainBtn');
        const toast = document.getElementById('toast');

        // Placeholders
        const placeholders = [
            "something heavy, something honest, something you've never said out loud...",
            "what's weighing on your heart right now?",
            "what would you say if no one was listening?",
            "what truth have you been holding back?",
            "what does your heart need to release today?",
            "what would feel lighter if you just said it?"
        ];

        userInput.placeholder = placeholders[Math.floor(Math.random() * placeholders.length)];

        // Loading messages
        const loadingMessages = [
            "the mirror is listening...",
            "breathing with your words...",
            "holding space for your truth...",
            "reflecting gently...",
            "finding the light in your words..."
        ];

        // ========================================
        // INPUT HANDLING
        // ========================================
        userInput.addEventListener('input', () => {
            const length = userInput.value.length;
            charCount.textContent = length;
            transformBtn.disabled = length === 0;
        });

        // ========================================
        // TRANSFORM
        // ========================================
        transformBtn.addEventListener('click', async () => {
            const input = userInput.value.trim();
            if (!input) return;

            // Show loading
            inputView.classList.remove('active');
            loadingView.classList.add('active');

            // Cycle through loading messages
            let msgIndex = 0;
            const loadingInterval = setInterval(() => {
                msgIndex = (msgIndex + 1) % loadingMessages.length;
                loadingText.textContent = loadingMessages[msgIndex];
            }, 2500);

            try {
                const response = await fetch('https://magicmirror.withouttoomuchthought.workers.dev/', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ input })
                });

                const data = await response.json();
                clearInterval(loadingInterval);

                if (data.reflection) {
                    originalText.textContent = `"${input}"`;
                    reflectionText.textContent = data.reflection;

                    loadingView.classList.remove('active');
                    resultView.classList.add('active');
                } else {
                    throw new Error('No reflection received');
                }
            } catch (error) {
                clearInterval(loadingInterval);
                console.error('Error:', error);
                showToast('something went wrong... try again? üíú');
                loadingView.classList.remove('active');
                inputView.classList.add('active');
            }
        });

        // ========================================
        // COPY
        // ========================================
        copyBtn.addEventListener('click', () => {
            const text = reflectionText.textContent;
            navigator.clipboard.writeText(text).then(() => {
                showToast('copied to clipboard üíú');
            });
        });

        // ========================================
        // SHARE
        // ========================================
        shareBtn.addEventListener('click', async () => {
            const text = reflectionText.textContent + '\n\n‚Äî magicmirror by @withouttoomuchthought ü™û‚ú®';
            
            if (navigator.share) {
                try {
                    await navigator.share({ text });
                } catch (e) {
                    fallbackCopy(text);
                }
            } else {
                fallbackCopy(text);
            }
        });

        function fallbackCopy(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('copied for sharing üíú');
            });
        }

        // ========================================
        // DOWNLOAD AS ART
        // ========================================
        downloadBtn.addEventListener('click', () => {
            const canvas = document.getElementById('downloadCanvas');
            const ctx = canvas.getContext('2d');

            // Story size (1080x1920)
            canvas.width = 1080;
            canvas.height = 1920;

            // Background gradient
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#E8E4F3');
            gradient.addColorStop(0.35, '#D9D7F3');
            gradient.addColorStop(0.65, '#E4DFF5');
            gradient.addColorStop(1, '#DDD8F0');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Settings
            ctx.textAlign = 'center';
            ctx.fillStyle = '#2F2F2F';

            // Mirror emoji
            ctx.font = '120px serif';
            ctx.fillText('ü™û', canvas.width / 2, 280);

            // Title
            ctx.font = '500 72px Playfair Display, Georgia, serif';
            ctx.fillText('magicmirror', canvas.width / 2, 420);

            // Reflection text
            ctx.font = '400 42px Karla, sans-serif';
            ctx.fillStyle = '#3A3A3A';
            const text = reflectionText.textContent;
            const lines = wrapText(ctx, text, canvas.width - 160, 42);
            
            const startY = 580;
            const lineHeight = 72;
            lines.forEach((line, i) => {
                ctx.fillText(line, canvas.width / 2, startY + (i * lineHeight));
            });

            // Footer
            ctx.font = 'italic 32px Karla, sans-serif';
            ctx.fillStyle = '#7A7A8A';
            ctx.fillText('a soft reflection by wtmt ü§ç', canvas.width / 2, canvas.height - 180);
            ctx.font = '28px Karla, sans-serif';
            ctx.fillText('@withouttoomuchthought', canvas.width / 2, canvas.height - 120);

            // Download
            const link = document.createElement('a');
            link.download = 'magicmirror-reflection.png';
            link.href = canvas.toDataURL('image/png');
            link.click();

            showToast('saved to your photos üíú');
        });

        function wrapText(ctx, text, maxWidth, fontSize) {
            const words = text.split(' ');
            const lines = [];
            let currentLine = '';

            words.forEach(word => {
                const testLine = currentLine + word + ' ';
                const metrics = ctx.measureText(testLine);
                if (metrics.width > maxWidth && currentLine !== '') {
                    lines.push(currentLine.trim());
                    currentLine = word + ' ';
                } else {
                    currentLine = testLine;
                }
            });
            lines.push(currentLine.trim());
            return lines;
        }

        // ========================================
        // TRY AGAIN
        // ========================================
        tryAgainBtn.addEventListener('click', () => {
            userInput.value = '';
            charCount.textContent = '0';
            transformBtn.disabled = true;
            userInput.placeholder = placeholders[Math.floor(Math.random() * placeholders.length)];
            
            resultView.classList.remove('active');
            inputView.classList.add('active');

            // Scroll to mirror section
            document.getElementById('mirror').scrollIntoView({ behavior: 'smooth' });
        });

        // ========================================
        // TOAST
        // ========================================
        function showToast(message) {
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // ========================================
        // SMOOTH SCROLL FOR ENTER BUTTON
        // ========================================
        document.querySelector('.enter-btn').addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('mirror').scrollIntoView({ behavior: 'smooth' });
        });

        // ========================================
        // CONSOLE MESSAGE
        // ========================================
        console.log('%cü™û magicmirror', 'font-size: 14px; color: #5A5A5A;');
        console.log('%ca soft reflection portal by wtmt', 'font-size: 12px; color: #888; font-style: italic;');
    </script>
</body>
</html>
